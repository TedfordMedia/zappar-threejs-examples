# Zappar WebGl Snapshot
This package allows you to easily implement a snapshot save/share functionality into your WebGL applications. It includes the ability to save the result and, where available, the native Web Share API makes it possible to social share to other apps installed on the device.
​

> <i class="fa fa-info-circle"></i> You may also be interested in:
>  - [Zappar for ThreeJS](https://www.npmjs.com/package/@zappar/zappar-threejs) (@zappar/zappar-threejs)
>  - [Zappar for AFrame](https://www.npmjs.com/package/@zappar/zappar-aframe) (@zappar/zappar-aframe)
> - Zappar's library for Unity
> - [Zappar for JavaScript](https://www.npmjs.com/package/@zappar/zappar) (@zappar/zappar), if you'd like to build content with a different 3D rendering platform
> - ZapWorks Studio, a full 3D development environment built for AR, VR and MR

## Installation
​
**Using NPM** 

​
Run the following NPM command inside your project directory:
​
```bash
npm install @zappar/webgl-snapshot
```
​
**CDN**

​
Once you've installed the library, reference `zappar-snapshot.min.js` from your HTML like this:
​
```html
<script src="https://libs.zappar.com/zappar-snapshot/0.0.15/zappar-snapshot.min.js"></script>
```
​
## Usage
​
**Importing**

​
Import the library into your JavaScript or TypeScript files:
​
```ts
import * as SnapshotManager from '@zappar/webgl-snapshot'
​
```
​
**Capturing the Canvas**

><i class="fa fa-info-circle"></i> This should be done **after** WebGL renders a frame or with​ `preserveDrawingBuffer` enabled.

Add this snippet into the event in which you would like the Save & Share Dialog to appear:
​
```ts
// Get canvas from dom
const canvas = document.querySelector('canvas');
​
// Convert canvas data to url
const url = canvas.toDataURL('image/jpeg', 0.8);
​
// Take snapshot
SnapshotManager.promptImage({
    data: url,
});
```
​
**Getting Callbacks from the Save & Share Dialog**

​
```ts
// ...
SnapshotManager.promptImage({
    data: url,
    onSave: () => {
        console.log(`Image was saved`)
    },
        onShare: () => {
        console.log('Share button was pressed');
    },
    onClose: () => {
        console.log('Dialog was closed');
    }
});
```
> <i class="fa fa-info-circle"></i> The arguments indicate if the user tapped on the Save or Share buttons in that dialog, but do not guarantee that the user actually completed those actions. `onClose` is called when the user returns from the Save/Share dialog. 
​
## Custom fields
​
**Custom File Name**

​
Pre-defined file name:
​
```ts
// ...
SnapshotManager.promptImage({
    data: url,
    fileNamePrepend: 'Zappar'
});
```
**Custom Share Title**

​
Pre-defined Share title:
​
```ts
// ...
SnapshotManager.promptImage({
    data: url,
    shareTitle: 'Hello World!'
});
```
​
**Custom Share Text**

​
Pre-filled Share dialog:
​
```ts
// ...
SnapshotManager.promptImage({
    data: url,
    shareText: 'Hello World!'
});
```
​
**Custom Share Url**

​
Pre-defined Share dialog:
​
```ts
// ...
SnapshotManager.promptImage({
    data: url,
    shareUrl: 'www.zappar.com'
});
```
​​
**Hide Share Button**

​
Pre-defined save dialog:
​
```ts
// ...
SnapshotManager.promptImage({
    data: url,
    hideShareButton: true,
});
```


**Editing Pre-Defined Styles**

​The package comes with a pre-defined style which you can override.

This can be done by passing a style object as a parameter into `promptImage` method as seen in the example.


```ts
// ...
SnapshotManager.promptImage({
    data: url,
    hideShareButton: true
}, {
    buttonCloseAnchor: {
        width: '15px',
        height: '15px',
    }
});
```

<details>
  <summary>Default Style Reference</summary>

```ts
saveShareAnchor: {
    display: 'flex',
    width: '46px',
    height: '46px',
    marginTop: '2.5%',
    marginLeft: '5%',
    marginRight: '5%',
  },
  buttonImage: {
    pointerEvents: 'none',
    display: 'flex',
    justifyContent: 'center',
    margin: 'auto',
  },
  buttonCloseAnchor: {
    width: '15px',
    height: '15px',
    marginLeft: '7%',
  },
  previewElement: {
    height: 'auto',
    width: '80%',
    marginLeft: 'auto',
    marginRight: 'auto',
    backgroundColor: '#ccc',
    boxShadow: '0px 0px 4px 0px rgba(0,0,0,0.5)',
    display: 'flex',
  },
  containerDiv: {
    position: 'fixed',
    width: '100%',
    height: '100%',
    top: '0px',
    left: '0px',
    zIndex: 10000,
    backgroundColor: 'rgba(255,255,255,1)',
    fontFamily: 'sans-serif',
    color: 'rgba(255,255,255,1)',
    display: 'flex',
    flexDirection: 'column',
    justifyContent: 'center',
  },
  flexContainerDiv: {
    display: 'flex',
    justifyContent: 'center',
    flexWrap: 'wrap',
  },
  buttonCloseImage: {
    pointerEvents: 'none',
    width: '15px',
    height: '15px',
  },
  buttonOpenFiles: {
    border: '2px solid black',
    textTransform: 'uppercase',
    padding: '10px',
    minWidth: '100px',
    color: 'black',
    display: 'inline - block',
    marginTop: '20px',
    textDecoration: 'none',
    borderRadius: '10px',
  },
  instructions: {
    color: 'black',
    marginBottom: '0',
    width: '100%',
    textAlign: 'center',
    display: 'none',
  },
```
</details>



**Localisations**

Custom text or localisations can be implemented via the `promptImage` parameter. 


```ts
// ...
SnapshotManager.promptImage({
    data: url,
    hideShareButton: true
}, {
    buttonCloseAnchor: {
        width: '15px',
        height: '15px',
    }
}, {
    SAVE: "SAVE",
    SHARE: "SHARE",
    NowOpenFilesAppToShare: "Now open files app to share",
    TapAndHoldToSave: "Tap and hold the image<br/>to save to your Photos app"
});
```


## Example
​
Using the snippets above, your script should now include:
​
```ts
import * as SnapshotManager from '@zappar/webgl-snapshot'
​
// Get canvas from dom
const canvas = document.querySelector('canvas');
​
// Convert canvas data to url
const url = canvas.toDataURL('image/jpeg', 0.8);
​
SnapshotManager.promptImage({
    data: url,
    fileNamePrepend: 'Zappar',
    shareUrl: 'www.zappar.com',
    shareTitle: 'Hello World!',
    shareText: 'Hello World!',
    onSave: () => {
        console.log(`Image was saved`)
    },
    onShare: () => {
        console.log('Share button was pressed');
    },
    onClose: () => {
        console.log('Dialog was closed');
    }
}, {
    SAVE: "SAVE",
    SHARE: "SHARE",
    NowOpenFilesAppToShare: "Now open files app to share",
    TapAndHoldToSave: "Tap and hold the image<br/>to save to your Photos app"
}
);
```


---
